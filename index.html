<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeutschMeister: –ù–µ–º–µ—Ü–∫–∏–π —Å 0 –¥–æ C1</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #FDFBF7; color: #1F2937; }
        .chart-container { position: relative; width: 100%; height: 300px; }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –∏ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ */
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }
        
        .phase-btn.active {
            background-color: #3B82F6; color: white; border-color: #3B82F6; transform: translateY(-2px);
        }

        /* Checkbox Customization */
        .custom-checkbox input:checked + div {
            background-color: #10B981;
            border-color: #10B981;
        }
        .custom-checkbox input:checked + div svg {
            display: block;
        }
    </style>
</head>
<body class="antialiased min-h-screen flex flex-col">

    <header class="bg-white border-b border-gray-200 sticky top-0 z-40 shadow-sm">
        <div class="max-w-6xl mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <span class="text-3xl">üá©üá™</span>
                <div>
                    <h1 class="text-xl font-bold text-gray-900 tracking-tight">DeutschMeister</h1>
                    <div class="flex items-center gap-2">
                        <span class="text-xs text-gray-500 font-medium">–°–∏—Å—Ç–µ–º–∞ 0 ‚Üí C1</span>
                        <span class="bg-orange-100 text-orange-700 text-xs px-2 py-0.5 rounded-full font-bold flex items-center gap-1">
                            üî• <span id="streak-count">0</span> –¥–Ω.
                        </span>
                    </div>
                </div>
            </div>
            <button onclick="openOnboarding()" class="text-sm text-blue-600 font-semibold hover:underline">
                ‚ÑπÔ∏è –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?
            </button>
        </div>
    </header>

    <main class="flex-grow max-w-6xl mx-auto px-4 py-8 w-full space-y-10">

        <section class="bg-white rounded-2xl shadow-sm border border-gray-100 p-2 md:p-4">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-2 md:gap-4" id="phase-nav"></div>
        </section>

        <section id="dashboard" class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            
            <div class="lg:col-span-7 space-y-6">
                
                <div class="bg-white rounded-xl p-6 shadow-sm border-l-4 border-blue-500 relative overflow-hidden">
                    <div class="absolute top-0 right-0 p-4 opacity-10">
                        <span class="text-9xl transform translate-x-4 -translate-y-4">üéØ</span>
                    </div>
                    <div class="relative z-10">
                        <div class="flex justify-between items-start mb-2">
                            <h3 id="phase-title" class="text-2xl font-bold text-gray-900">–ó–∞–≥—Ä—É–∑–∫–∞...</h3>
                        </div>
                        <p id="phase-desc" class="text-gray-600 mb-4 leading-relaxed text-sm"></p>
                        <div class="bg-blue-50 inline-block px-3 py-1 rounded-lg border border-blue-100">
                            <span class="text-xs text-blue-800 font-bold uppercase tracking-wide">–ì–ª–∞–≤–Ω–∞—è —Ü–µ–ª—å: </span>
                            <span id="phase-goal" class="text-sm font-semibold text-gray-900 ml-1">...</span>
                        </div>
                    </div>
                </div>

                <div class="bg-gradient-to-br from-amber-50 to-orange-50 rounded-xl p-6 border border-amber-100 shadow-md">
                    <div class="flex justify-between items-center mb-4">
                        <h4 class="text-lg font-bold text-gray-800 flex items-center gap-2">
                            <span>‚úÖ</span> –ü–ª–∞–Ω –Ω–∞ —Å–µ–≥–æ–¥–Ω—è (40 –º–∏–Ω)
                        </h4>
                        <button id="reset-day-btn" onclick="resetDailyProgress()" class="text-xs text-gray-400 hover:text-red-500 underline hidden">–°–±—Ä–æ—Å–∏—Ç—å –¥–µ–Ω—å</button>
                    </div>
                    
                    <div id="routine-list" class="space-y-3">
                        </div>

                    <p class="text-xs text-center text-gray-400 mt-4 italic">
                        "–†–µ–≥—É–ª—è—Ä–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–µ–µ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏. –ù–µ –ª–æ–∂–∏—Ç–µ—Å—å —Å–ø–∞—Ç—å, –ø–æ–∫–∞ –Ω–µ –∑–∞–∫—Ä–æ–µ—Ç–µ –≤—Å–µ –≥–∞–ª–æ—á–∫–∏."
                    </p>
                </div>
            </div>

            <div class="lg:col-span-5 space-y-6">
                
                <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-100">
                    <h4 class="text-sm font-bold text-gray-700 uppercase mb-3 flex items-center gap-2">
                        üìÖ –¢—Ä–µ–∫–µ—Ä —Ä–µ–≥—É–ª—è—Ä–Ω–æ—Å—Ç–∏
                    </h4>
                    <p class="text-xs text-gray-500 mb-4">–ó–∞–∫—Ä–∞—à–∏–≤–∞–π—Ç–µ –¥–Ω–∏. –ü—Ä–æ–ø—É—Å–∫–∏ —É–±–∏–≤–∞—é—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å.</p>
                    <div class="flex gap-1 justify-between mb-4" id="week-tracker">
                        </div>
                    <div class="bg-gray-50 p-3 rounded-lg border border-gray-200 text-center">
                         <div class="text-xs text-gray-500 mb-1">–í–∞—à —Ç–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å (–ø—Ä–∏–º–µ—Ä–Ω–æ)</div>
                         <div id="current-level-display" class="text-2xl font-bold text-blue-600">A0</div>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-white p-4 rounded-xl border border-gray-100 shadow-sm text-center">
                        <div class="text-2xl font-bold text-gray-800 mb-1" id="metric-vocab">0</div>
                        <div class="text-xs text-gray-500">–°–ª–æ–≤ (–¶–µ–ª—å)</div>
                    </div>
                    <div class="bg-white p-4 rounded-xl border border-gray-100 shadow-sm text-center">
                        <div class="text-2xl font-bold text-emerald-600 mb-1" id="metric-hours">0</div>
                        <div class="text-xs text-gray-500">–ß–∞—Å–æ–≤ –ø–æ–≥—Ä—É–∂–µ–Ω–∏—è</div>
                    </div>
                </div>

                <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-100 h-64">
                    <canvas id="routineChart"></canvas>
                </div>
            </div>
        </section>

        <section id="setup" class="bg-gray-100 rounded-2xl p-6 md:p-8">
            <h3 class="text-xl font-bold text-gray-900 mb-4">üõ† –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤</h3>
            <div class="grid md:grid-cols-3 gap-4">
                <a href="https://apps.ankiweb.net/" target="_blank" class="block p-4 bg-white rounded-lg border hover:border-blue-400 transition">
                    <div class="font-bold mb-1">1. Anki (–°–ª–æ–≤–∞)</div>
                    <div class="text-xs text-gray-500">–°–∫–∞—á–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –¥–ª—è –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—ã—Ö –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π.</div>
                </a>
                <a href="https://www.deepl.com/" target="_blank" class="block p-4 bg-white rounded-lg border hover:border-blue-400 transition">
                    <div class="font-bold mb-1">2. DeepL (–ü–µ—Ä–µ–≤–æ–¥)</div>
                    <div class="text-xs text-gray-500">–¢–æ—á–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫.</div>
                </a>
                <a href="https://www.dw.com/en/learn-german/s-2469" target="_blank" class="block p-4 bg-white rounded-lg border hover:border-blue-400 transition">
                    <div class="font-bold mb-1">3. DW Learn German</div>
                    <div class="text-xs text-gray-500">–ë–∞–∑–æ–≤—ã–π –∫—É—Ä—Å (Nicos Weg).</div>
                </a>
            </div>
        </section>

    </main>

    <div id="task-modal" class="fixed inset-0 z-50 hidden modal-backdrop flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 transform transition-all scale-100">
            <div class="flex justify-between items-center mb-4 border-b pb-2">
                <h3 id="modal-task-title" class="text-xl font-bold text-gray-900">–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è</h3>
                <button onclick="closeTaskModal()" class="text-gray-400 hover:text-gray-600 text-2xl">&times;</button>
            </div>
            <div id="modal-task-content" class="text-gray-700 space-y-4 text-sm leading-relaxed">
                </div>
            <div class="mt-6 text-right">
                <button onclick="closeTaskModal()" class="bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 transition">–ü–æ–Ω—è—Ç–Ω–æ, –ø—Ä–∏—Å—Ç—É–ø–∞—é</button>
            </div>
        </div>
    </div>

    <div id="onboarding-modal" class="fixed inset-0 z-50 hidden modal-backdrop flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full p-8 relative">
            <div class="text-center mb-6">
                <div class="text-5xl mb-4">üá©üá™ üöÄ</div>
                <h2 class="text-2xl font-bold text-gray-900">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ DeutschMeister</h2>
                <p class="text-gray-500 mt-2">–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏ –≤–∞—à–µ–≥–æ –ø—É—Ç–∏ –∫ C1</p>
            </div>
            
            <div class="space-y-4 mb-8 text-sm md:text-base text-gray-700">
                <div class="flex gap-3">
                    <span class="bg-blue-100 text-blue-800 font-bold w-6 h-6 flex items-center justify-center rounded-full shrink-0">1</span>
                    <p><strong>–ú–µ—Ç–æ–¥–∏–∫–∞ 40 –º–∏–Ω—É—Ç:</strong> –ú—ã —Ä–∞–∑–±–∏–ª–∏ 1.5 –≥–æ–¥–∞ –Ω–∞ 4 —Ñ–∞–∑—ã. –ù–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–∞—à–µ–≥–æ 40-–º–∏–Ω—É—Ç–Ω–æ–≥–æ –∑–∞–Ω—è—Ç–∏—è –º–µ–Ω—è–µ—Ç—Å—è. –°–ª–µ–¥–∏—Ç–µ –∑–∞ –¥–∏–∞–≥—Ä–∞–º–º–æ–π!</p>
                </div>
                <div class="flex gap-3">
                    <span class="bg-blue-100 text-blue-800 font-bold w-6 h-6 flex items-center justify-center rounded-full shrink-0">2</span>
                    <p><strong>–í–∞—à Dashboard:</strong> –≠—Ç–æ –≤–∞—à –ø—É–ª—å—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è. –ó–¥–µ—Å—å —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á –Ω–∞ —Å–µ–≥–æ–¥–Ω—è. <br> <span class="text-emerald-600 font-semibold">–ù–∞–∂–∏–º–∞–π—Ç–µ –Ω–∞ –∑–Ω–∞–∫ ¬´?¬ª —Ä—è–¥–æ–º —Å –∑–∞–¥–∞—á–µ–π</span>, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ç–æ—á–Ω—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é (–∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Anki, —á—Ç–æ —Å–º–æ—Ç—Ä–µ—Ç—å, –∫–∞–∫ –ø–∏—Å–∞—Ç—å).</p>
                </div>
                <div class="flex gap-3">
                    <span class="bg-blue-100 text-blue-800 font-bold w-6 h-6 flex items-center justify-center rounded-full shrink-0">3</span>
                    <p><strong>–ú–∞–≥–∏—è –ö–∞–ª–µ–Ω–¥–∞—Ä—è:</strong> –ò–∑—É—á–µ–Ω–∏–µ —è–∑—ã–∫–∞ ‚Äî —ç—Ç–æ –º–∞—Ä–∞—Ñ–æ–Ω. –ì–ª–∞–≤–Ω—ã–π –≤—Ä–∞–≥ ‚Äî –ø—Ä–æ–ø—É—Å–∫–∏. –û—Ç–º–µ—á–∞–π—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –¥–Ω–∏ –≥–∞–ª–æ—á–∫–∞–º–∏. –°–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç —Ö–≤–∞–ª–∏—Ç—å –≤–∞—Å.</p>
                </div>
            </div>

            <button onclick="finishOnboarding()" class="w-full bg-blue-600 text-white py-3 rounded-xl font-bold text-lg hover:bg-blue-700 shadow-lg transition transform hover:scale-[1.01]">
                –Ø –≥–æ—Ç–æ–≤ –Ω–∞—á–∞—Ç—å! Los geht's!
            </button>
        </div>
    </div>

    <footer class="text-center py-6 text-gray-400 text-xs">
        <p>¬© 2026 DeutschMeister. Interactive Plan.</p>
    </footer>

    <script>
        // --- DATA STATE (–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è) ---
        const appData = [
            {
                id: 0,
                title: "–§–∞–∑–∞ 1: –§—É–Ω–¥–∞–º–µ–Ω—Ç",
                duration: "–ú–µ—Å—è—Ü 0-3",
                goal: "A1 - –í—ã–∂–∏–≤–∞–Ω–∏–µ",
                level: "A0",
                desc: "–°–∞–º—ã–π —Å–ª–æ–∂–Ω—ã–π —ç—Ç–∞–ø ‚Äî –∑–∞–ø—É—Å–∫ –¥–≤–∏–≥–∞—Ç–µ–ª—è. –í—ã –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç–µ, –∏ —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ. –í–∞—à–∞ —Ü–µ–ª—å: –Ω–µ —É—á–∏—Ç—å ¬´–≤—Å–µ –ø–æ–¥—Ä—è–¥¬ª, –∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤ –≥–æ–ª–æ–≤—É —Ñ–æ–Ω–µ—Ç–∏–∫—É –∏ 500 —Å–∞–º—ã—Ö –≤–∞–∂–Ω—ã—Ö —Å–ª–æ–≤.",
                metrics: { vocab: "500-800", hours: "60" },
                routine: [
                    { 
                        activity: "Anki (–õ–µ–∫—Å–∏–∫–∞)", 
                        time: 15, 
                        color: "#3B82F6",
                        instruction: "<strong>–¶–µ–ª—å:</strong> –í—ã—É—á–∏—Ç—å —Ç–æ–ø-500 —Å–ª–æ–≤.<br><br>1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Anki.<br>2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ª–∏–º–∏—Ç: 10 –Ω–æ–≤—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫ –≤ –¥–µ–Ω—å.<br>3. –ö–æ–≥–¥–∞ –≤–∏–¥–∏—Ç–µ –∫–∞—Ä—Ç–æ—á–∫—É, –ø—Ä–æ–∏–∑–Ω–µ—Å–∏—Ç–µ —Å–ª–æ–≤–æ –≤—Å–ª—É—Ö.<br>4. <strong>–í–∞–∂–Ω–æ:</strong> –£—á–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –°–†–ê–ó–£ —Å –∞—Ä—Ç–∏–∫–ª–µ–º (Der/Die/Das). –¶–≤–µ—Ç–æ–º –≤—ã–¥–µ–ª—è–π—Ç–µ —Ä–æ–¥ (–°–∏–Ω–∏–π-Der, –ö—Ä–∞—Å–Ω—ã–π-Die, –ó–µ–ª–µ–Ω—ã–π-Das)."
                    },
                    { 
                        activity: "–ì—Ä–∞–º–º–∞—Ç–∏–∫–∞ (–ë–∞–∑–∞)", 
                        time: 15, 
                        color: "#F59E0B",
                        instruction: "<strong>–†–µ—Å—É—Ä—Å:</strong> –£—á–µ–±–Ω–∏–∫ –∏–ª–∏ YouTube (–õ–∏—Å—Ç '–ù–µ–º–µ—Ü–∫–∏–π A1').<br><br>–ò–∑—É—á–∞–µ–º —Ç–æ–ª—å–∫–æ:<br>- –°–ø—Ä—è–∂–µ–Ω–∏–µ –≥–ª–∞–≥–æ–ª–æ–≤ –≤ –Ω–∞—Å—Ç–æ—è—â–µ–º –≤—Ä–µ–º–µ–Ω–∏ (ich mache, du machst).<br>- –ü–æ—Ä—è–¥–æ–∫ —Å–ª–æ–≤ (–ì–ª–∞–≥–æ–ª –í–°–ï–ì–î–ê –Ω–∞ 2 –º–µ—Å—Ç–µ).<br>- –û—Ç—Ä–∏—Ü–∞–Ω–∏–µ (nicht/kein).<br>–ù–µ –ª–µ–∑—å—Ç–µ –≤ –¥–µ–±—Ä–∏ –ø–∞–¥–µ–∂–µ–π –ø–æ–∫–∞ —á—Ç–æ."
                    },
                    { 
                        activity: "–ê—É–¥–∏—Ä–æ–≤–∞–Ω–∏–µ (–§–æ–Ω)", 
                        time: 10, 
                        color: "#10B981",
                        instruction: "<strong>–†–µ—Å—É—Ä—Å:</strong> –ü–æ–¥–∫–∞—Å—Ç—ã 'Slow German' –∏–ª–∏ –≤–∏–¥–µ–æ –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤.<br><br>–ü—Ä–æ—Å—Ç–æ —Å–ª—É—à–∞–π—Ç–µ, –ø–æ–∫–∞ –º–æ–µ—Ç–µ –ø–æ—Å—É–¥—É –∏–ª–∏ –∏–¥–µ—Ç–µ. –ù–µ –ø—ã—Ç–∞–π—Ç–µ—Å—å –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å –∫–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ. –ü—Ä–∏–≤—ã–∫–∞–π—Ç–µ –∫ –º–µ–ª–æ–¥–∏–∫–µ —è–∑—ã–∫–∞."
                    }
                ]
            },
            {
                id: 1,
                title: "–§–∞–∑–∞ 2: –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ",
                duration: "–ú–µ—Å—è—Ü 4-9",
                goal: "A2/B1 - –ü–æ–Ω–∏–º–∞–Ω–∏–µ",
                level: "A1 ‚Üí A2",
                desc: "–ó–æ–ª–æ—Ç–æ–µ –≤—Ä–µ–º—è. –ü–µ—Ä–µ—Å—Ç–∞–µ–º –∑—É–±—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –∏ –Ω–∞—á–∏–Ω–∞–µ–º ¬´–ø–æ—Ç—Ä–µ–±–ª—è—Ç—å¬ª —è–∑—ã–∫. –í—ã —Å–º–æ—Ç—Ä–∏—Ç–µ —Å–µ—Ä–∏–∞–ª—ã –∏ —á–∏—Ç–∞–µ—Ç–µ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–Ω–∏–≥–∏.",
                metrics: { vocab: "2000+", hours: "180" },
                routine: [
                    { 
                        activity: "Anki (–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ)", 
                        time: 10, 
                        color: "#3B82F6", 
                        instruction: "–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –¥–µ–ª–∞—Ç—å Anki, –Ω–æ —Ç–µ–ø–µ—Ä—å –¥–æ–±–∞–≤–ª—è–µ–º —Ç—É–¥–∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å–ª–æ–≤–∞, –∞ —Ü–µ–ª—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –≤—Å—Ç—Ä–µ—Ç–∏–ª–∏ –≤ –≤–∏–¥–µ–æ –∏–ª–∏ –∫–Ω–∏–≥–∞—Ö."
                    },
                    { 
                        activity: "–ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ (Input)", 
                        time: 25, 
                        color: "#10B981", 
                        instruction: "<strong>–≠—Ç–æ —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ –≤—Ä–µ–º—è.</strong><br>1. <strong>Nicos Weg (DW):</strong> –ü—Ä–æ—Ö–æ–¥–∏—Ç–µ –ø–æ 1 —É—Ä–æ–∫—É –≤ –¥–µ–Ω—å.<br>2. <strong>Easy German (YouTube):</strong> –°–º–æ—Ç—Ä–∏—Ç–µ –∏–Ω—Ç–µ—Ä–≤—å—é –Ω–∞ —É–ª–∏—Ü–µ. –í–∫–ª—é—á–∞–π—Ç–µ —Å—É–±—Ç–∏—Ç—Ä—ã. –ï—Å–ª–∏ —Ñ—Ä–∞–∑–∞ –Ω—Ä–∞–≤–∏—Ç—Å—è ‚Äî –≤ Anki.<br>3. –ß–∏—Ç–∞–π—Ç–µ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–Ω–∏–≥–∏ —É—Ä–æ–≤–Ω—è A2 (Dino lernt Deutsch)."
                    },
                    { 
                        activity: "–ì—Ä–∞–º–º–∞—Ç–∏–∫–∞ (–°–ø—Ä–∞–≤–æ—á–Ω–æ)", 
                        time: 5, 
                        color: "#F59E0B", 
                        instruction: "–û—Ç–∫—Ä—ã–≤–∞–π—Ç–µ –≥—Ä–∞–º–º–∞—Ç–∏–∫—É –¢–û–õ–¨–ö–û –µ—Å–ª–∏ –≤—ã –≤—Å—Ç—Ä–µ—Ç–∏–ª–∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—é 3 —Ä–∞–∑–∞ –∏ –Ω–µ –ø–æ–Ω—è–ª–∏, –ø–æ—á–µ–º—É –æ–Ω–∞ —Ç–∞–∫ —Å—Ç—Ä–æ–∏—Ç—Å—è. –£—á–∏–º ¬´–æ—Ç –ø—Ä–æ–±–ª–µ–º—ã¬ª, –∞ –Ω–µ ¬´–æ—Ç —É—á–µ–±–Ω–∏–∫–∞¬ª."
                    }
                ]
            },
            {
                id: 2,
                title: "–§–∞–∑–∞ 3: –ê–∫—Ç–∏–≤–∞—Ü–∏—è",
                duration: "–ú–µ—Å—è—Ü 10-15",
                goal: "B2 - –°–≤–æ–±–æ–¥–∞",
                level: "B1 ‚Üí B2",
                desc: "–ü–æ—Ä–∞ –≥–æ–≤–æ—Ä–∏—Ç—å. –í—ã –º–Ω–æ–≥–æ –ø–æ–Ω–∏–º–∞–µ—Ç–µ, –Ω–æ —Ä–æ—Ç –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è. –õ–æ–º–∞–µ–º –±–∞—Ä—å–µ—Ä —á–µ—Ä–µ–∑ –ø—Ä–∞–∫—Ç–∏–∫—É –∏ –ø–∏—Å—å–º–æ.",
                metrics: { vocab: "3500+", hours: "360" },
                routine: [
                    { 
                        activity: "Anki (–§—Ä–∞–∑—ã)", 
                        time: 10, 
                        color: "#3B82F6", 
                        instruction: "–£–¥–∞–ª—è–π—Ç–µ –ø—Ä–æ—Å—Ç—ã–µ —Å–ª–æ–≤–∞ (–∫–æ—Ç, –¥–æ–º). –û—Å—Ç–∞–≤–ª—è–π—Ç–µ —Ç–æ–ª—å–∫–æ —Å–ª–æ–∂–Ω—ã–µ –∏–¥–∏–æ–º—ã –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥–ª–∞–≥–æ–ª–æ–≤ (–∂–¥–∞—Ç—å –ö–û–ì–û? warten AUF)."
                    },
                    { 
                        activity: "–ù–∞—Ç–∏–≤–Ω—ã–π –ö–æ–Ω—Ç–µ–Ω—Ç", 
                        time: 20, 
                        color: "#10B981", 
                        instruction: "–ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ Netflix. –°–µ—Ä–∏–∞–ª—ã 'Dark', 'How to Sell Drugs Online'. –°—É–±—Ç–∏—Ç—Ä—ã ‚Äî –Ω–µ–º–µ—Ü–∫–∏–µ (–Ω–µ —Ä—É—Å—Å–∫–∏–µ!). –ü—ã—Ç–∞–π—Ç–µ—Å—å —É–≥–∞–¥—ã–≤–∞—Ç—å —Å–º—ã—Å–ª."
                    },
                    { 
                        activity: "–ì–æ–≤–æ—Ä–µ–Ω–∏–µ/–ü–∏—Å—å–º–æ", 
                        time: 10, 
                        color: "#EF4444", 
                        instruction: "<strong>–ê–∫—Ç–∏–≤–Ω–∞—è —Ñ–∞–∑–∞:</strong><br>1. <strong>–ü–∏—Å—å–º–æ:</strong> –ü–∏—à–∏—Ç–µ 5 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –æ —Å–≤–æ–µ–º –¥–Ω–µ. –ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ –∏—Ö –≤ DeepL –Ω–∞ —Ä—É—Å—Å–∫–∏–π, –∞ –ø–æ—Ç–æ–º –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ –Ω–µ–º–µ—Ü–∫–∏–π. –°—Ä–∞–≤–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.<br>2. <strong>Shadowing:</strong> –í–∫–ª—é—á–∏—Ç–µ –≤–∏–¥–µ–æ, —Å—Ç–∞–≤—å—Ç–µ –ø–∞—É–∑—É –∏ –ø–æ–≤—Ç–æ—Ä—è–π—Ç–µ –∑–∞ –¥–∏–∫—Ç–æ—Ä–æ–º, –∫–æ–ø–∏—Ä—É—è –∏–Ω—Ç–æ–Ω–∞—Ü–∏—é."
                    }
                ]
            },
            {
                id: 3,
                title: "–§–∞–∑–∞ 4: –ú–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ",
                duration: "–ú–µ—Å—è—Ü 16-18",
                goal: "C1 - –ü—Ä–æ—Ñ–∏",
                level: "C1",
                desc: "–®–ª–∏—Ñ–æ–≤–∫–∞. –°–ª–æ–∂–Ω–∞—è –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞, –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –ª–µ–∫—Å–∏–∫–∞, –Ω–æ–≤–æ—Å—Ç–∏ –∏ –Ω–∞—É—á–Ω—ã–µ —Å—Ç–∞—Ç—å–∏.",
                metrics: { vocab: "5000+", hours: "500+" },
                routine: [
                    { activity: "Anki (–ù—é–∞–Ω—Å—ã)", time: 5, color: "#3B82F6", instruction: "–ö–∞—Ä—Ç–æ—á–∫–∏ —Å —Å–∏–Ω–æ–Ω–∏–º–∞–º–∏. –í —á–µ–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É √§ndern, ver√§ndern –∏ wechseln?" },
                    { activity: "–°–ª–æ–∂–Ω—ã–π –ö–æ–Ω—Ç–µ–Ω—Ç", time: 30, color: "#10B981", instruction: "–ù–æ–≤–æ—Å—Ç–∏ (Tagesschau). –ü–æ–¥–∫–∞—Å—Ç—ã –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏. –ß–∏—Ç–∞–π—Ç–µ Spiegel –∏–ª–∏ Zeit." },
                    { activity: "C1 –ì—Ä–∞–º–º–∞—Ç–∏–∫–∞", time: 5, color: "#F59E0B", instruction: "Konjunktiv I (–¥–ª—è –∫–æ—Å–≤–µ–Ω–Ω–æ–π —Ä–µ—á–∏), —Å–ª–æ–∂–Ω—ã–µ –ø–∞—Å—Å–∏–≤–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ç–µ—Å—Ç—É Goethe/TestDaF." }
                ]
            }
        ];

        let currentPhase = 0;
        let routineChartInstance = null;
        let checkedTasks = new Set(); // Stores indices of checked tasks for current day

        document.addEventListener('DOMContentLoaded', () => {
            checkOnboarding();
            renderPhaseNav();
            loadPhase(0);
            renderWeekTracker();
            
            // Check streak from local storage (Simulation)
            const streak = localStorage.getItem('dm_streak') || 0;
            document.getElementById('streak-count').innerText = streak;
        });

        // --- ONBOARDING LOGIC ---
        function checkOnboarding() {
            if (!localStorage.getItem('dm_onboarding_done')) {
                openOnboarding();
            }
        }
        
        function openOnboarding() {
            document.getElementById('onboarding-modal').classList.remove('hidden');
        }

        function finishOnboarding() {
            localStorage.setItem('dm_onboarding_done', 'true');
            document.getElementById('onboarding-modal').classList.add('hidden');
            // Celebrate start
            confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
        }

        // --- CORE LOGIC ---

        function renderPhaseNav() {
            const navContainer = document.getElementById('phase-nav');
            navContainer.innerHTML = appData.map((phase, index) => `
                <button 
                    onclick="loadPhase(${index})"
                    class="phase-btn flex flex-col items-center justify-center p-3 rounded-xl border border-gray-200 transition-all hover:bg-gray-50 bg-white text-gray-600"
                    id="btn-phase-${index}"
                >
                    <span class="text-xs font-bold uppercase mb-1 opacity-70">${phase.duration}</span>
                    <span class="text-sm font-bold text-center leading-tight">${phase.title.split(':')[0]}</span>
                </button>
            `).join('');
        }

        function loadPhase(index) {
            currentPhase = index;
            const data = appData[index];

            // Styles
            document.querySelectorAll('.phase-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`btn-phase-${index}`).classList.add('active');

            // Text Data
            document.getElementById('phase-title').textContent = data.title;
            document.getElementById('phase-desc').textContent = data.desc;
            document.getElementById('phase-goal').textContent = data.goal;
            document.getElementById('current-level-display').textContent = data.level;

            // Metrics
            document.getElementById('metric-vocab').textContent = data.metrics.vocab;
            document.getElementById('metric-hours').textContent = data.metrics.hours;

            // Routine List Generation (With Interactive Elements)
            renderRoutineList(data.routine);
            
            // Chart
            updateRoutineChart(data.routine);
        }

        function renderRoutineList(routine) {
            const list = document.getElementById('routine-list');
            checkedTasks.clear(); // Reset daily checks when changing phase (simplified logic)
            document.getElementById('reset-day-btn').classList.add('hidden');

            list.innerHTML = routine.map((item, i) => `
                <div class="flex items-center justify-between bg-white p-3 rounded-lg border border-gray-100 shadow-sm hover:shadow-md transition-shadow group">
                    <div class="flex items-center gap-3">
                        <label class="custom-checkbox relative flex items-center cursor-pointer">
                            <input type="checkbox" class="sr-only" onchange="toggleTask(${i}, this)">
                            <div class="w-6 h-6 border-2 border-gray-300 rounded-md transition-colors flex items-center justify-center bg-white group-hover:border-blue-400">
                                <svg class="w-4 h-4 text-white hidden pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path></svg>
                            </div>
                        </label>
                        
                        <div>
                            <div class="flex items-center gap-2">
                                <span class="w-2 h-2 rounded-full" style="background-color: ${item.color}"></span>
                                <span class="text-sm font-bold text-gray-800">${item.activity}</span>
                            </div>
                            <span class="text-xs text-gray-400">${item.time} –º–∏–Ω</span>
                        </div>
                    </div>

                    <button onclick="openTaskModal(${i})" class="bg-blue-50 text-blue-600 hover:bg-blue-100 px-3 py-1 rounded text-xs font-semibold transition flex items-center gap-1">
                        <span>‚ùì</span> <span class="hidden sm:inline">–ö–∞–∫ –¥–µ–ª–∞—Ç—å?</span>
                    </button>
                </div>
            `).join('');
        }

        // --- INTERACTIVITY ---

        function toggleTask(index, checkbox) {
            if (checkbox.checked) {
                checkedTasks.add(index);
                // Check if all completed
                const totalTasks = appData[currentPhase].routine.length;
                if (checkedTasks.size === totalTasks) {
                    completeDay();
                }
            } else {
                checkedTasks.delete(index);
            }
        }

        function completeDay() {
            // Animation
            confetti({
                particleCount: 150,
                spread: 100,
                origin: { y: 0.6 },
                colors: ['#3B82F6', '#10B981', '#F59E0B']
            });

            // Update Streak Logic (Mock)
            let streak = parseInt(localStorage.getItem('dm_streak') || 0);
            streak++;
            localStorage.setItem('dm_streak', streak);
            document.getElementById('streak-count').innerText = streak;
            
            // Show reset button
            document.getElementById('reset-day-btn').classList.remove('hidden');
        }
        
        function resetDailyProgress() {
            renderRoutineList(appData[currentPhase].routine);
        }

        function renderWeekTracker() {
            const container = document.getElementById('week-tracker');
            // Generate 7 circles, random fill for demo
            let html = '';
            const days = ['–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±', '–í—Å'];
            days.forEach((day, i) => {
                const active = i < new Date().getDay(); // Mock: fill days until today
                const colorClass = active ? 'bg-blue-500 text-white border-blue-500' : 'bg-white text-gray-400 border-gray-200';
                html += `
                    <div class="flex flex-col items-center gap-1">
                        <div class="w-8 h-8 rounded-full border-2 flex items-center justify-center text-xs font-bold ${colorClass}">
                            ${active ? '‚úì' : ''}
                        </div>
                        <span class="text-[10px] uppercase text-gray-400">${day}</span>
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        // --- MODAL LOGIC (TASK INSTRUCTION) ---
        function openTaskModal(taskIndex) {
            const task = appData[currentPhase].routine[taskIndex];
            document.getElementById('modal-task-title').innerText = task.activity;
            document.getElementById('modal-task-content').innerHTML = task.instruction;
            document.getElementById('task-modal').classList.remove('hidden');
        }

        function closeTaskModal() {
            document.getElementById('task-modal').classList.add('hidden');
        }

        // --- CHART ---
        function updateRoutineChart(routine) {
            const ctx = document.getElementById('routineChart').getContext('2d');
            const data = routine.map(r => r.time);
            const labels = routine.map(r => r.activity.split('(')[0]);
            const colors = routine.map(r => r.color);

            if (routineChartInstance) routineChartInstance.destroy();

            routineChartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: colors,
                        borderWidth: 0,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'right', labels: { boxWidth: 10, usePointStyle: true } }
                    }
                }
            });
        }
    </script>
</body>
</html>