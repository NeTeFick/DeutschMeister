<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DeutschMeister Pro | C1 Blueprint</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
        
        :root {
            --brand-primary: #4F46E5;
            --brand-secondary: #6366F1;
            --bg-main: #F8FAFC;
        }

        body { 
            font-family: 'Inter', sans-serif; 
            background-color: var(--bg-main);
            color: #1E293B;
            -webkit-tap-highlight-color: transparent;
            overscroll-behavior-y: contain;
            user-select: none;
        }

        .glass-nav {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
        }

        .premium-card {
            background: white;
            border: 1px solid rgba(226, 232, 240, 0.5);
            box-shadow: 0 4px 20px -5px rgba(0, 0, 0, 0.05);
            transition: all 0.25s cubic-bezier(0.2, 0.8, 0.2, 1);
        }

        .premium-card:active {
            transform: scale(0.97);
        }

        /* –£–ª—É—á—à–µ–Ω–Ω—ã–π –°–≤–∏—Ç—á */
        .switch-track {
            width: 52px;
            height: 31px;
            border-radius: 99px;
            position: relative;
            transition: background-color 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
        }

        .switch-knob {
            width: 27px;
            height: 27px;
            background: white;
            border-radius: 50%;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 0 3px 8px rgba(0,0,0,0.15), 0 1px 1px rgba(0,0,0,0.05);
        }

        .switch-on .switch-track { background-color: #34C759; }
        .switch-on .switch-knob { transform: translateX(21px); }
        .switch-off .switch-track { background-color: #E9E9EB; }

        .animate-fade-in {
            animation: fadeIn 0.5s cubic-bezier(0.22, 1, 0.36, 1) forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        
        .tab-active { color: var(--brand-primary); }
        
        .tab-active::after {
            content: '';
            position: absolute;
            bottom: -10px;
            width: 4px;
            height: 4px;
            background: var(--brand-primary);
            border-radius: 50%;
        }

        .btn-active:active { transform: scale(0.96); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
        import { getAuth, onAuthStateChanged, signInAnonymously, signInWithCustomToken, signInWithPopup, GoogleAuthProvider, signOut } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-auth.js";
        import { getFirestore, doc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-firestore.js";

        const { useState, useEffect, useMemo } = React;

        const firebaseConfig = JSON.parse(__firebase_config);
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'deutsch-meister-v1';

        const PHASES = [
            { id: 0, level: 'A1', name: '–ó–∞–∫–ª–∞–¥–∫–∞ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞', days: 90, res: 'Nicos Weg A1 + Anki', tasksA: [{id:'a1_1', title:'Nicos Weg: –ê–Ω–∞–ª–∏–∑ —Å—é–∂–µ—Ç–∞', time:20, type:'Input'}, {id:'a1_2', title:'Anki: 15 –Ω–æ–≤—ã—Ö —Å–ª–æ–≤', time:10, type:'Memory'}, {id:'a1_3', title:'V2 Rule: –ü–æ—Ä—è–¥–æ–∫ —Å–ª–æ–≤', time:10, type:'Study'}], tasksB: [{id:'b1_1', title:'Shadowing: –ü–æ–≤—Ç–æ—Ä –∑–∞ Nico', time:15, type:'Output'}, {id:'b1_2', title:'Anki: –ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ', time:15, type:'Memory'}, {id:'b1_3', title:'SST: –ú–æ–Ω–æ–ª–æ–≥ (1 –º–∏–Ω)', time:10, type:'Output'}] },
            { id: 1, level: 'A2', name: '–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ –∫–∞—Ä–∫–∞—Å–∞', days: 90, res: 'Nicos Weg A2 + Dino lernt Deutsch', tasksA: [{id:'a2_1', title:'Perfekt: –ì–ª—É–±–æ–∫–∏–π —Ä–∞–∑–±–æ—Ä', time:20, type:'Input'}, {id:'a2_2', title:'Dino lernt Deutsch: –ì–ª–∞–≤–∞', time:15, type:'Input'}, {id:'a2_3', title:'Anki: –§—Ä–∞–∑–æ–≤—ã–µ –≥–ª–∞–≥–æ–ª—ã', time:5, type:'Memory'}], tasksB: [{id:'b2_1', title:'–°–∏–Ω—Ç–µ–∑: –ü–∏—Å—å–º–æ –¥—Ä—É–≥—É', time:20, type:'Output'}, {id:'b2_2', title:'Anki: –û–±—â–∏–π —Å—Ç–µ–∫', time:15, type:'Memory'}, {id:'b2_3', title:'ChatGPT: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∏—Å—å–º–∞', time:5, type:'Output'}] },
            { id: 2, level: 'B1', name: '–ü—Ä–µ–æ–¥–æ–ª–µ–Ω–∏–µ –ø–æ—Ä–æ–≥–∞', days: 150, res: 'Easy German Podcast + Reading', tasksA: [{id:'a3_1', title:'–ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ–µ —á—Ç–µ–Ω–∏–µ —Å—Ç–∞—Ç—å–∏', time:25, type:'Input'}, {id:'a3_2', title:'Anki: –ö–æ–ª–ª–æ–∫–∞—Ü–∏–∏ B1', time:10, type:'Memory'}, {id:'a3_3', title:'Nebens√§tze: –°–æ—é–∑—ã', time:5, type:'Study'}], tasksB: [{id:'b3_1', title:'–ê—Ä–≥—É–º–µ–Ω—Ç–∞—Ü–∏—è (Warum)', time:20, type:'Output'}, {id:'b3_2', title:'Shadowing: Easy German', time:15, type:'Output'}, {id:'b3_3', title:'Anki: –ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –¥–Ω—è', time:5, type:'Memory'}] },
            { id: 3, level: 'B2', name: '–ü–æ–ª–Ω–æ–µ –ø–æ–≥—Ä—É–∂–µ–Ω–∏–µ', days: 120, res: '–†–æ–º–∞–Ω: Tschick + DW Nachrichten', tasksA: [{id:'a4_1', title:'Tschick: –ß—Ç–µ–Ω–∏–µ 5 —Å—Ç—Ä–∞–Ω–∏—Ü', time:25, type:'Input'}, {id:'a4_2', title:'B2 Vocabulary —Å—Ç–µ–∫', time:10, type:'Memory'}, {id:'a4_3', title:'Passiv: –í—Å–µ —Ñ–æ—Ä–º—ã', time:5, type:'Study'}], tasksB: [{id:'b4_1', title:'–†–µ—Ü–µ–Ω–∑–∏—è (—É—Å—Ç–Ω–æ)', time:20, type:'Output'}, {id:'b4_2', title:'–î–µ–±–∞—Ç—ã —Å ChatGPT', time:15, type:'Output'}, {id:'b4_3', title:'Anki: –ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞—è —á–∏—Å—Ç–∫–∞', time:5, type:'Memory'}] },
            { id: 4, level: 'C1', name: '–ú–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ', days: 97, res: 'Die Zeit + –ê–∫–∞–¥–µ–º–∏—á–µ—Å–∫–æ–µ –ø–∏—Å—å–º–æ', tasksA: [{id:'a5_1', title:'Die Zeit: –†–∞–∑–±–æ—Ä –ª–æ–Ω–≥—Ä–∏–¥–∞', time:25, type:'Input'}, {id:'a5_2', title:'C1 Academic Vocab', time:10, type:'Memory'}, {id:'a5_3', title:'TestDaF: –ß—Ç–µ–Ω–∏–µ (—Ç–∞–π–º–µ—Ä)', time:5, type:'Study'}], tasksB: [{id:'b5_1', title:'–ü–∏—Å—å–º–æ C1 (Grafikanalyse)', time:25, type:'Output'}, {id:'b5_2', title:'–ú–æ–Ω–æ–ª–æ–≥: –ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è', time:10, type:'Output'}, {id:'b5_3', title:'Anki: –§–∏–Ω–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å', time:5, type:'Memory'}] }
        ];

        const INITIAL_STATE = { 
            currentPhaseId: 0, 
            completedTasks: [], 
            streak: 0, 
            startDate: new Date().toISOString(), 
            lastActivityDate: null, 
            history: {}, 
            autoAdvance: true 
        };

        const Icon = ({ name, className = "w-6 h-6" }) => {
            const icons = {
                zap: <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z" />,
                chart: <path d="M18 20V10M12 20V4M6 20v-6" />,
                book: <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z" />,
                map: <path d="M1 6l7-4 8 4 7-4v16l-7 4-8-4-7 4V6z M8 2v16 M16 6v16" />,
                gear: <path d="M12 15a3 3 0 100-6 3 3 0 000 6z M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z" />,
                check: <path d="M20 6L9 17l-5-5" />,
                copy: <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2 M9 2h6v4H9z" />
            };
            return (
                <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round">
                    {icons[name]}
                </svg>
            );
        };

        function App() {
            const [user, setUser] = useState(null);
            const [view, setView] = useState('home');
            const [state, setState] = useState(null);
            const [syncing, setSyncing] = useState(false);
            const [copyStatus, setCopyStatus] = useState(false);
            const [modal, setModal] = useState(null);

            useEffect(() => {
                const init = async () => {
                    if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                        await signInWithCustomToken(auth, __initial_auth_token);
                    } else {
                        await signInAnonymously(auth);
                    }
                };
                init();
                return onAuthStateChanged(auth, setUser);
            }, []);

            useEffect(() => {
                if (!user) return;
                const docRef = doc(db, 'artifacts', appId, 'users', user.uid, 'settings', 'main');
                return onSnapshot(docRef, (snap) => {
                    if (snap.exists()) setState(snap.data());
                    else setDoc(docRef, INITIAL_STATE).then(() => setState(INITIAL_STATE));
                });
            }, [user]);

            const save = async (updates) => {
                if (!user || !state) return;
                setSyncing(true);
                const docRef = doc(db, 'artifacts', appId, 'users', user.uid, 'settings', 'main');
                await setDoc(docRef, { ...state, ...updates }, { merge: true });
                setSyncing(false);
            };

            const daysPassed = useMemo(() => {
                if (!state?.startDate) return 0;
                const start = new Date(state.startDate);
                start.setHours(0,0,0,0);
                const now = new Date();
                now.setHours(0,0,0,0);
                return Math.floor((now - start) / 86400000);
            }, [state?.startDate]);

            const currentPhase = state ? PHASES[state.currentPhaseId] : PHASES[0];
            const isDayA = daysPassed % 2 === 0;
            const tasks = isDayA ? currentPhase.tasksA : currentPhase.tasksB;

            useEffect(() => {
                if (!state || !state.autoAdvance) return;
                let cum = 0, target = 0;
                for (let i = 0; i < PHASES.length; i++) {
                    cum += PHASES[i].days;
                    if (daysPassed < cum) { target = i; break; }
                    if (i === PHASES.length - 1) target = i;
                }
                if (state.currentPhaseId !== target) save({ currentPhaseId: target, completedTasks: [] });
            }, [daysPassed, state?.autoAdvance]);

            const onToggle = (tid) => {
                const done = state.completedTasks.includes(tid);
                const newList = done ? state.completedTasks.filter(x => x !== tid) : [...state.completedTasks, tid];
                const todayHuman = new Date().toDateString();
                const todayKey = new Date().toISOString().split('T')[0];

                let nStreak = state.streak;
                if (!done && state.lastActivityDate !== todayHuman) {
                    const last = state.lastActivityDate ? new Date(state.lastActivityDate) : null;
                    const yest = new Date(); yest.setDate(yest.getDate() - 1);
                    nStreak = (!last || last.toDateString() === yest.toDateString()) ? nStreak + 1 : 1;
                }

                const nHistory = { ...state.history, [todayKey]: newList.length };
                save({ completedTasks: newList, streak: nStreak, lastActivityDate: todayHuman, history: nHistory });
            };

            if (!state) return (
                <div className="h-screen flex items-center justify-center bg-white">
                    <div className="w-10 h-10 border-[3px] border-indigo-50 border-t-indigo-600 rounded-full animate-spin" />
                </div>
            );

            return (
                <div className="max-w-md mx-auto min-h-screen flex flex-col relative pb-32">
                    {modal && (
                        <div className="fixed inset-0 z-[100] flex items-end sm:items-center justify-center p-4 bg-slate-900/40 backdrop-blur-md animate-fade-in">
                            <div className="bg-white rounded-[2.5rem] p-8 w-full max-w-sm shadow-2xl">
                                <h3 className="text-xl font-extrabold mb-3">–í–Ω–∏–º–∞–Ω–∏–µ</h3>
                                <p className="text-slate-500 text-sm mb-8 leading-relaxed">{modal.text}</p>
                                <div className="flex flex-col gap-3">
                                    <button onClick={() => { modal.onConfirm(); setModal(null); }} className="w-full bg-slate-900 text-white py-4 rounded-2xl font-bold text-sm tracking-tight btn-active">–ü—Ä–∏–Ω—è—Ç—å</button>
                                    <button onClick={() => setModal(null)} className="w-full bg-slate-100 text-slate-500 py-4 rounded-2xl font-bold text-sm tracking-tight">–û—Ç–º–µ–Ω–∞</button>
                                </div>
                            </div>
                        </div>
                    )}

                    <header className="sticky top-0 z-[60] glass-nav border-b border-slate-100 p-6 flex justify-between items-center">
                        <div className="flex items-center gap-4">
                            <div className={`w-12 h-12 bg-indigo-600 rounded-2xl flex items-center justify-center text-white shadow-xl shadow-indigo-100 transition-all ${syncing ? 'scale-110 opacity-80' : ''}`}>
                                <Icon name="zap" className="w-6 h-6 fill-current" />
                            </div>
                            <div>
                                <h1 className="text-xl font-black italic tracking-tighter leading-none uppercase text-slate-900">Meister</h1>
                                <p className="text-[10px] font-extrabold text-indigo-500 uppercase tracking-widest mt-1.5 flex items-center gap-1.5">
                                    <span className="w-1.5 h-1.5 bg-indigo-500 rounded-full animate-pulse" />
                                    Phase {currentPhase.level}
                                </p>
                            </div>
                        </div>
                        <div className="flex items-center gap-3">
                            {user && !user.isAnonymous ? (
                                <button onClick={() => signOut(auth)} className="relative group">
                                    <img src={user.photoURL} className="w-10 h-10 rounded-2xl border-2 border-white shadow-md" alt="P" />
                                    <div className="absolute -bottom-1 -right-1 w-3.5 h-3.5 bg-green-500 border-[3px] border-white rounded-full" />
                                </button>
                            ) : (
                                <button onClick={() => signInWithPopup(auth, new GoogleAuthProvider())} className="bg-slate-900 text-white text-[10px] px-5 py-2.5 rounded-xl font-bold uppercase tracking-wider btn-active">–í–æ–π—Ç–∏</button>
                            )}
                        </div>
                    </header>

                    <main className="flex-grow p-6 no-scrollbar overflow-y-auto">
                        {view === 'home' && (
                            <div className="space-y-8 animate-fade-in">
                                <div className="flex justify-between items-end">
                                    <div className="space-y-1.5">
                                        <p className="text-[10px] font-black text-slate-400 uppercase tracking-widest leading-none">
                                            {isDayA ? '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–∏–∫–ª' : '–ê–∫—Ç–∏–≤–Ω—ã–π —Ü–∏–∫–ª'}
                                        </p>
                                        <h2 className="text-3xl font-black text-slate-900 leading-none">–ü–ª–∞–Ω —Å–µ–≥–æ–¥–Ω—è</h2>
                                    </div>
                                    <div className="bg-orange-50 text-orange-600 px-4 py-2 rounded-2xl text-[11px] font-black tracking-wider flex items-center gap-2">
                                        üî• {state.streak} –î–ù–ï–ô
                                    </div>
                                </div>

                                <div className="bg-slate-900 rounded-[3rem] p-9 text-white shadow-2xl relative overflow-hidden">
                                    <div className="relative z-10 space-y-5">
                                        <div className="flex justify-between items-center mb-4">
                                            <h3 className="text-xl font-black italic tracking-tight uppercase">–°–ø—Ä–∏–Ω—Ç <span className="text-indigo-400">40–º</span></h3>
                                        </div>
                                        {tasks.map(t => (
                                            <div 
                                                key={t.id} 
                                                onClick={() => onToggle(t.id)}
                                                className={`p-5 rounded-[2rem] flex items-center gap-5 cursor-pointer transition-all border ${state.completedTasks.includes(t.id) ? 'bg-white/5 border-white/5 opacity-40' : 'bg-white/10 border-white/10 hover:bg-white/15'}`}
                                            >
                                                <div className={`w-10 h-10 rounded-2xl border-2 flex items-center justify-center transition-all ${state.completedTasks.includes(t.id) ? 'bg-indigo-500 border-indigo-500 shadow-xl' : 'border-white/20'}`}>
                                                    {state.completedTasks.includes(t.id) && <Icon name="check" className="w-5 h-5" />}
                                                </div>
                                                <div className="flex-grow">
                                                    <p className={`font-bold text-sm tracking-tight ${state.completedTasks.includes(t.id) ? 'line-through' : ''}`}>{t.title}</p>
                                                    <div className="flex items-center gap-3 mt-1.5 opacity-40">
                                                        <span className="text-[9px] font-black uppercase tracking-widest">{t.time}–º ‚Ä¢ {t.type}</span>
                                                    </div>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                    <div className="absolute top-0 right-0 w-64 h-64 bg-indigo-500/10 blur-[100px] -mr-32 -mt-32 rounded-full" />
                                </div>

                                <div className="premium-card rounded-[2.5rem] p-8 space-y-4">
                                    <h4 className="text-[11px] font-black text-slate-400 uppercase tracking-widest">–û—Å–Ω–æ–≤–Ω–æ–π —Ä–µ—Å—É—Ä—Å</h4>
                                    <p className="font-bold text-slate-800 text-base leading-snug">{currentPhase.res}</p>
                                </div>
                            </div>
                        )}

                        {view === 'stats' && (
                            <div className="space-y-8 animate-fade-in">
                                <h2 className="text-3xl font-black text-slate-900 italic">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                                <div className="grid grid-cols-2 gap-5">
                                    <div className="bg-indigo-600 p-8 rounded-[2.8rem] text-white shadow-xl shadow-indigo-100">
                                        <p className="text-[10px] font-black uppercase opacity-60 mb-2 tracking-widest">–ß–∞—Å–æ–≤</p>
                                        <p className="text-3xl font-black">{Math.floor((daysPassed * 40) / 60)}</p>
                                    </div>
                                    <div className="premium-card p-8 rounded-[2.8rem]">
                                        <p className="text-[10px] font-black uppercase text-slate-400 mb-2 tracking-widest">–ó–∞–¥–∞—á</p>
                                        <p className="text-3xl font-black text-slate-800">{Object.values(state.history || {}).reduce((a,b) => a+b, 0)}</p>
                                    </div>
                                </div>

                                <div className="premium-card p-9 rounded-[3rem]">
                                    <p className="text-[10px] font-black text-slate-400 uppercase tracking-widest text-center mb-10">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–µ–¥–µ–ª–∏</p>
                                    <div className="h-44 flex items-end justify-between px-2">
                                        {[...Array(7)].map((_, i) => {
                                            const d = new Date(); d.setDate(d.getDate() - (6 - i));
                                            const k = d.toISOString().split('T')[0];
                                            const val = (state.history?.[k] || 0) / 3;
                                            return (
                                                <div key={i} className="flex flex-col items-center gap-4">
                                                    <div className="w-7 bg-slate-50 rounded-full h-32 relative overflow-hidden border border-slate-100">
                                                        <div 
                                                            className="absolute bottom-0 w-full bg-indigo-500 transition-all duration-700 rounded-full" 
                                                            style={{ height: `${val * 100}%` }}
                                                        />
                                                    </div>
                                                    <span className="text-[9px] font-black text-slate-300 uppercase">{d.toLocaleDateString('ru', {weekday:'short'})}</span>
                                                </div>
                                            );
                                        })}
                                    </div>
                                </div>
                            </div>
                        )}

                        {view === 'method' && (
                            <div className="space-y-8 animate-fade-in">
                                <h2 className="text-3xl font-black text-slate-900 italic">–ú–µ—Ç–æ–¥</h2>
                                <div className="bg-indigo-600 p-10 rounded-[3rem] text-white shadow-2xl relative overflow-hidden">
                                    <h4 className="text-xl font-black mb-4 italic uppercase">SST Protocol</h4>
                                    <p className="text-sm opacity-80 leading-relaxed mb-10 font-medium">–í—ã –≥–æ–≤–æ—Ä–∏—Ç–µ 70% –≤—Ä–µ–º–µ–Ω–∏. –£—á–∏—Ç–µ–ª—å ‚Äî –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä. –ê–∫—Ç–∏–≤–Ω–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Å–æ–∑–¥–∞–µ—Ç –ø—Ä–æ—á–Ω—ã–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–≤—è–∑–∏.</p>
                                    <div className="bg-white/10 p-5 rounded-2xl border border-white/20 backdrop-blur-md text-center">
                                        <p className="text-[11px] font-black uppercase tracking-widest">–ê–∫—Ç–∏–≤–∞—Ü–∏—è —Ü–µ–Ω—Ç—Ä–∞ –ë—Ä–æ–∫–∞</p>
                                    </div>
                                </div>

                                <div className="premium-card p-9 rounded-[3rem] space-y-8">
                                    <div className="space-y-4">
                                        <h4 className="text-[11px] font-black text-indigo-600 uppercase tracking-widest">–¶–≤–µ—Ç–æ–≤—ã–µ –º–µ—Ç–∫–∏</h4>
                                        <div className="flex gap-3">
                                            {['DER (B)', 'DIE (R)', 'DAS (G)'].map((l, i) => (
                                                <div key={i} className={`flex-1 py-4 rounded-2xl text-[10px] font-black text-white text-center shadow-lg ${i===0?'bg-blue-500':i===1?'bg-rose-500':'bg-emerald-500'}`}>{l}</div>
                                            ))}
                                        </div>
                                    </div>
                                    <button 
                                        onClick={() => {
                                            const p = `–¢—å—é—Ç–æ—Ä: –æ–±—ä—è—Å–Ω—è–π –Ω–∞ —É—Ä–æ–≤–Ω–µ ${currentPhase.level}. –†–æ–¥ —Å–ª–æ–≤ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω.`;
                                            navigator.clipboard.writeText(p);
                                            setCopyStatus(true);
                                            setTimeout(() => setCopyStatus(false), 2000);
                                        }}
                                        className="w-full bg-slate-900 py-6 rounded-[2rem] flex items-center justify-center gap-4 text-white font-bold text-[12px] uppercase tracking-widest shadow-xl btn-active"
                                    >
                                        <Icon name={copyStatus ? 'check' : 'copy'} className="w-5 h-5" />
                                        {copyStatus ? '–°–ö–û–ü–ò–†–û–í–ê–ù–û' : 'COPY AI PROMPT'}
                                    </button>
                                </div>
                            </div>
                        )}

                        {view === 'map' && (
                            <div className="space-y-5 animate-fade-in">
                                <h2 className="text-3xl font-black text-slate-900 mb-6 italic">–ú–∞—Ä—à—Ä—É—Ç</h2>
                                {PHASES.map((p, idx) => (
                                    <div 
                                        key={p.id} 
                                        onClick={() => setModal({
                                            text: `–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —ç—Ç–∞–ø ${p.level}?`,
                                            onConfirm: () => { save({ currentPhaseId: idx, autoAdvance: false, completedTasks: [] }); setView('home'); }
                                        })}
                                        className={`premium-card p-8 rounded-[2.8rem] relative overflow-hidden flex flex-col gap-2 ${state.currentPhaseId === idx ? 'ring-2 ring-indigo-500 !bg-indigo-50' : 'opacity-60 grayscale hover:grayscale-0'}`}
                                    >
                                        <div className="flex justify-between items-center">
                                            <span className="text-[11px] font-black text-indigo-500 uppercase tracking-widest">{p.days}–¥</span>
                                            <span className="text-3xl font-black italic opacity-10">{p.level}</span>
                                        </div>
                                        <h3 className="text-xl font-black text-slate-800 tracking-tighter leading-none">{p.name}</h3>
                                        {state.currentPhaseId === idx && (
                                            <div className="absolute top-4 right-4 bg-indigo-500 p-2 rounded-full text-white">
                                                <Icon name="check" className="w-4 h-4" />
                                            </div>
                                        )}
                                    </div>
                                ))}
                            </div>
                        )}

                        {view === 'settings' && (
                            <div className="space-y-8 animate-fade-in">
                                <h2 className="text-3xl font-black text-slate-900 italic">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                                <div className="premium-card p-9 rounded-[3rem] space-y-10">
                                    <div className="flex items-center justify-between">
                                        <div className="space-y-1.5">
                                            <p className="font-black text-slate-800 text-sm uppercase tracking-tight">–ê–≤—Ç–æ-–ø—Ä–æ–≥—Ä–µ—Å—Å</p>
                                            <p className="text-[10px] text-slate-400 font-bold uppercase tracking-widest leading-none italic">–ü–æ –¥–Ω—è–º –æ–±—É—á–µ–Ω–∏—è</p>
                                        </div>
                                        {/* –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å (Switch) */}
                                        <div 
                                            className={`${state.autoAdvance ? 'switch-on' : 'switch-off'}`}
                                            onClick={() => save({ autoAdvance: !state.autoAdvance })}
                                        >
                                            <div className="switch-track">
                                                <div className="switch-knob"></div>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="space-y-4 pt-8 border-t border-slate-50">
                                        <button 
                                            onClick={() => window.open('https://calendar.google.com', '_blank')}
                                            className="w-full bg-slate-900 p-6 rounded-[1.8rem] text-white font-bold text-[11px] uppercase tracking-widest shadow-xl flex items-center justify-between btn-active"
                                        >
                                            Google Calendar üìÖ
                                        </button>
                                        <button 
                                            onClick={() => setModal({
                                                text: "–°–±—Ä–æ—Å–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ?",
                                                onConfirm: () => { save(INITIAL_STATE); setView('home'); }
                                            })}
                                            className="w-full p-6 text-rose-500 font-bold text-[11px] uppercase tracking-widest bg-rose-50 rounded-[1.8rem] border border-rose-100 btn-active"
                                        >
                                            –£–¥–∞–ª–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é
                                        </button>
                                    </div>
                                </div>
                                <div className="text-center">
                                    <p className="text-[9px] font-black text-slate-300 uppercase tracking-[0.4em]">Meister Premium Cloud</p>
                                </div>
                            </div>
                        )}
                    </main>

                    <nav className="fixed bottom-0 left-0 right-0 glass-nav border-t border-slate-100 px-8 pb-12 pt-6 z-[60] rounded-t-[3.5rem] shadow-[0_-15px_50px_-20px_rgba(0,0,0,0.1)]">
                        <div className="max-w-md mx-auto flex justify-between items-center">
                            {[
                                { id: 'home', icon: 'zap', label: '–ü–ª–∞–Ω' },
                                { id: 'stats', icon: 'chart', label: '–°—Ç–∞—Ç—Å' },
                                { id: 'method', icon: 'book', label: '–ú–µ—Ç–æ–¥' },
                                { id: 'map', icon: 'map', label: '–ö–∞—Ä—Ç–∞' },
                                { id: 'settings', icon: 'gear', label: '–û–ø—Ü–∏–∏' }
                            ].map(item => (
                                <button 
                                    key={item.id}
                                    onClick={() => setView(item.id)}
                                    className={`flex flex-col items-center gap-2.5 transition-all relative ${view === item.id ? 'tab-active' : 'text-slate-300 hover:text-slate-400'}`}
                                >
                                    <Icon name={item.icon} className={`w-6 h-6 ${view === item.id ? 'fill-current' : ''}`} />
                                    <span className="text-[9px] font-black uppercase tracking-tighter">{item.label}</span>
                                </button>
                            ))}
                        </div>
                    </nav>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

